{"ast":null,"code":"import _regeneratorRuntime from\"/Users/spatel46/Documents/Enterprise Programming/Assignment/sabihapatel20060719/FilmFrontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/spatel46/Documents/Enterprise Programming/Assignment/sabihapatel20060719/FilmFrontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/spatel46/Documents/Enterprise Programming/Assignment/sabihapatel20060719/FilmFrontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useContext}from'react';import'./App.css';import{BrowserRouter as Router,Route,Routes,useLocation}from'react-router-dom';import Films from'./Films';import EditFilm from'./CRUD';import CRUD from'./CRUD';import{FormGroup,Input}from'reactstrap';import{useNavigate}from\"react-router-dom\";import AppContext from'./AppContext.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";console.log(\"AppContext\",AppContext.format);var App=function App(){var _useState=useState('json'),_useState2=_slicedToArray(_useState,2),format=_useState2[0],setFormat=_useState2[1];return/*#__PURE__*/_jsx(AppContext.Provider,{value:{format:format,setFormat:setFormat},children:/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",element:/*#__PURE__*/_jsx(Films,{})}),/*#__PURE__*/_jsx(Route,{path:\"/films/:id\",element:/*#__PURE__*/_jsx(EditFilm,{})}),/*#__PURE__*/_jsx(Route,{path:\"/films/add\",element:/*#__PURE__*/_jsx(CRUD,{})})]})})});};var Format=function Format(){//const [format, setFormat] = useState('format');\nvar _useContext=useContext(AppContext),format=_useContext.format,setFormat=_useContext.setFormat;var navigate=useNavigate();var location=useLocation();var handleFormat=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:console.log(\"Dropdown: \",event.target.value);AppContext.format=event.target.value;//added \nsetFormat(event.target.value);// do the get request only if the current page is /FilmAPI/filmapi\nif(!(location.pathname==='/FilmAPI/filmapi')){_context.next=6;break;}_context.next=6;return handleSubmit(event,event.target.value);case 6:case\"end\":return _context.stop();}},_callee);}));return function handleFormat(_x){return _ref.apply(this,arguments);};}();// changed this to call fetch everytime the dropdown is changed\n// added selected format to update value correctly + removed <Form> as this is done by handleFormat\nvar handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(event,selectedFormat){var accept;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:accept=\"application/json\";event.preventDefault();if(selectedFormat===\"xml\"){accept=\"application/xml\";}else if(selectedFormat===\"text\"){accept=\"text/plain\";}else{accept=\"application/json\";}_context2.next=5;return fetch(\"/FilmAPI/filmapi\",{method:\"GET\",headers:{Accept:accept,\"Content-Type\":accept}});case 5:navigate(\"/\");case 6:case\"end\":return _context2.stop();}},_callee2);}));return function handleSubmit(_x2,_x3){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"ms-4 me-3 row pt-4\",children:/*#__PURE__*/_jsx(FormGroup,{children:/*#__PURE__*/_jsxs(Input,{type:\"select\",name:\"formatType\",value:format,onChange:handleFormat,className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"json\",children:\"JSON\"}),/*#__PURE__*/_jsx(\"option\",{value:\"xml\",children:\"XML\"}),/*#__PURE__*/_jsx(\"option\",{value:\"text\",children:\"Text\"})]})})});};export{App,Format};","map":{"version":3,"names":["React","useState","useContext","BrowserRouter","Router","Route","Routes","useLocation","Films","EditFilm","CRUD","FormGroup","Input","useNavigate","AppContext","console","log","format","App","setFormat","Format","navigate","location","handleFormat","event","target","value","pathname","handleSubmit","selectedFormat","accept","preventDefault","fetch","method","headers","Accept"],"sources":["/Users/spatel46/Documents/Enterprise Programming/Assignment/sabihapatel20060719/FilmFrontend/src/App.js"],"sourcesContent":["import React, { useState, useContext} from 'react';\nimport './App.css';\nimport { BrowserRouter as Router, Route, Routes, useLocation } from 'react-router-dom';\nimport Films from './Films';\nimport EditFilm from './CRUD';\nimport CRUD from './CRUD';\n\n\nimport { FormGroup, Input } from 'reactstrap';\nimport { useNavigate } from \"react-router-dom\";\nimport AppContext from './AppContext.js';\n\nconsole.log(\"AppContext\",AppContext.format);\nconst App = () => {\n\n  const [format, setFormat] = useState('json');\n\n  return (\n    <AppContext.Provider value={{ format, setFormat }}>\n      <Router>\n      <Routes>\n        <Route exact path=\"/\" element={<Films/>}/>\n        <Route path='/films/:id' element={<EditFilm/>}/>\n        <Route path='/films/add' element={<CRUD/>}/>\n      </Routes>\n    </Router>\n    </AppContext.Provider>\n  )\n}\n\nconst Format = () => {\n  //const [format, setFormat] = useState('format');\n  const { format, setFormat } = useContext(AppContext);\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  const handleFormat = async (event) => {\n    console.log(\"Dropdown: \", event.target.value);\n    AppContext.format = event.target.value;\n    //added \n    setFormat(event.target.value);\n\n      // do the get request only if the current page is /FilmAPI/filmapi\n      if (location.pathname === '/FilmAPI/filmapi') {\n        await handleSubmit(event, event.target.value);\n      }\n    //await handleSubmit(event, event.target.value);\n  };\n\n  // changed this to call fetch everytime the dropdown is changed\n  // added selected format to update value correctly + removed <Form> as this is done by handleFormat\n  const handleSubmit = async (event, selectedFormat) => {\n    let accept = \"application/json\";\n    event.preventDefault();  \n \n    if (selectedFormat === \"xml\")\n    {\n      accept = \"application/xml\";\n    }\n    else if (selectedFormat === \"text\")\n    {\n      accept = \"text/plain\";\n    }\n    else \n    {\n      accept = \"application/json\";\n    }\n\n\n   await fetch(`/FilmAPI/filmapi`, \n   {\n      method: \"GET\",\n      headers: {\n        Accept: accept,\n        \"Content-Type\": accept,\n      },\n      \n    })\n    \n\n    navigate(\"/\");\n\n  };\n\n  return (\n    <div className = \"ms-4 me-3 row pt-4\"> \n      <FormGroup>\n        <Input \n          type=\"select\" \n          name=\"formatType\" \n          value={format} \n          onChange={handleFormat}\n          className='mb-2'\n        >\n            <option value=\"json\">JSON</option>\n            <option value=\"xml\">XML</option>\n            <option value=\"text\">Text</option>\n        </Input>\n      </FormGroup>\n    </div>\n    \n  );\n};\n\nexport { App,Format };"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}